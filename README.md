# VTT Innovation Duplication Analysis

## 🚀 Quick Start

### Prerequisites

- Python 3.9+
- [uv](https://github.com/astral-sh/uv) package manager

### 1. Setup Environment

```bash
# Clone and navigate to project
cd vtt-innovation-duplication

# Install dependencies with uv
uv sync
```

### 2. Create Required Directories and Files

```bash
# unzip data.zip
unzip data.zip

# Create results directory
mkdir -p data/results

# Create Azure config (see setup section below)
mkdir -p data/keys
```

### 3. Configure Azure OpenAI (Required for OpenAI embeddings)

Create `data/keys/azure_config.json` with your Azure OpenAI credentials:

```json
{
  "gpt-4.1-mini": {
    "api_base": "https://your-resource.cognitiveservices.azure.com/openai/deployments/gpt-4.1-mini/chat/completions?api-version=2025-01-01-preview",
    "api_version": "2025-01-01-preview",
    "api_key": "your-api-key-here",
    "deployment": "gpt-4.1-mini",
    "eval_deployment": "gpt-4.1-mini",
    "emb_deployment": "text-embedding-3-large"
  }
}
```

## 📊 Data Pipeline

### Step 1: Data Analysis (Jupyter Notebook)

Run the main analysis in the Jupyter notebook:

```bash
uv run jupyter lab
# Open and run main.ipynb
```

**What it does:**

#### **Data Extraction & Preprocessing**

- Loads VTT domain relationships (`df_relationships_vtt_domain.csv`)
- Loads comparison domain relationships (`df_relationships_comp_url.csv`)
- Filters for "DEVELOPED_BY" relationships
- Identifies documents with VTT presence
- Creates text for comparison: `"source id - source description | Developed by target english_id"`
- Outputs: `data/results/df_combined.csv` and `data/results/df_comp_domain_vtt_present.csv`

#### **Embedding Generation**

- Supports both local SentenceTransformer and Azure OpenAI embeddings
- Generates semantic embeddings for the "text_to_compare" field
- Outputs: `data/results/embeddings.csv` with embedding vectors

#### **Similarity Analysis & Grouping**

- Calculates cosine similarity matrices between all embeddings
- Tests multiple similarity thresholds (0.6 to 0.99) to analyze grouping behavior
- Groups similar pairs into connected components using graph traversal (DFS)
- Analyzes relationship between threshold, number of groups, and group sizes
- Identifies potential innovation duplications above specified threshold (default: 0.8)

#### **Visualization & Analysis**

- Uses PCA to reduce embeddings to 2D for visualization
- Creates scatter plots colored by duplicate groups
- Generates threshold analysis charts showing:
  - Number of groups vs threshold
  - Number of similar pairs vs threshold
  - Mean group size vs threshold

#### **LLM-Based Validation**

- Uses Azure OpenAI (GPT-4.1-mini) to validate potential duplicate groups
- Identifies and removes false positives from groups
- Structured validation with reasoning using Pydantic models
- Async processing for efficient batch validation

#### **Final Outputs**

- `data/results/duplicates.csv` - All identified duplicates
- `data/results/groups_final.json` - Initial similarity groups
- `data/results/enhanced_groups.json` - Validated groups after LLM review
- `data/results/results_with_reasoning.json` - LLM validation results with reasoning

### Step 2: Launch Visualization Dashboard

```bash
uv run streamlit run viz.py
```

**Features:**

- Interactive network graphs showing innovation relationships
- Embedding visualizations (projections with pca)
- Performance metrics and confusion matrices
- Overview of duplication analysis results

## 📁 Project Structure

```
vtt-innovation-duplication/
├── data/
│   ├── dataframes/           # Input CSV files
│   │   ├── df_relationships_vtt_domain.csv
│   │   ├── df_relationships_comp_url.csv
│   │   ├── df_combined.csv   # Generated by data_extractor.py
│   │   └── embeddings.csv    # Generated by embedding_generator.py
│   ├── results/              # Output files (create this folder)
│   └── keys/                 # API keys (create this folder)
│       └── azure_config.json # Azure OpenAI config
├── data_extractor.py         # Step 1: Data preparation
├── embedding_generator.py    # Step 2: Embedding generation
├── viz.py                   # Step 3: Streamlit dashboard
├── main.ipynb              # Jupyter notebook for analysis
├── pyproject.toml          # uv configuration
└── README.md
```

## 🔬 Analysis Components

### Data Extractor (`data_extractor.py`)

- **Purpose**: Prepare and filter innovation relationship data
- **Key Method**: `filter_vtt_present_docs()` - identifies documents containing VTT
- **Output**: Combined dataset with VTT and comparison domains

### Embedding Generator (`embedding_generator.py`)

- **Purpose**: Convert text descriptions to semantic vectors
- **Methods**:
  - Local: SentenceTransformer models (offline)
  - OpenAI: Azure OpenAI text-embedding-3-large (API-based)
- **Output**: High-dimensional embeddings for similarity analysis

### Visualization (`viz.py`)

- **Purpose**: Interactive dashboard for exploring results
- **Tabs**:
  - Overview: Project metrics and summary
  - Network Graph: Interactive innovation relationship networks
  - Embeddings: 2D projections of embedding space
  - Performance: Model evaluation metrics

## 🎯 Project Purpose

This project was developed for analyzing innovation duplication patterns in research organizations. The goal is to:

1. **Identify Potential Duplications**: Find similar innovations across different domains
2. **Network Analysis**: Visualize relationships between organizations and innovations
3. **Semantic Understanding**: Use advanced NLP to understand innovation descriptions
4. **Interactive Exploration**: Provide tools for researchers to explore the data

## 🔧 Development

### Adding Dependencies

```bash
uv add package-name
```

### Development Dependencies

```bash
uv sync --dev  # Includes jupyter, pytest, black, flake8
```

### Running Jupyter Notebooks

```bash
uv run jupyter lab
```
